;  =============================================================
;# __ C:\SCRIPTER\SCRIPTER CODE -- AUTOHOTKEY\Autokey -- 85-CHECK DISK CHKDSK AR MEDIA CARD.ahk
;# __ 
;# __ Autokey -- 85-CHECK DISK CHKDSK AR MEDIA CARD.ahk
;# __ 
;# BY Matthew __ Matt.Lan@Btinternet.com __ 
;# __ 
;# START       TIME [ Sun 19-Jan-2020 08:05:24 10:20:00
;# UNTIL       TIME [ Sun 19-Jan-2020 10:20:00 -- 2 HOUR 15 MINUTE
;# __ 

;# LAST EDITOR TIME [ Tue 21-Jan-2020 16:35:01
;# UNTIL       TIME [ Tue 21-Jan-2020 21:00:00 -- 4 HOUR 23 MINUTE
;# __ 
;  =============================================================

; ------------------------------------------------------------------
; Location Internet
;---------------------------------------------------------------------
; ----
; Matthew-Lancaster/Autokey -- 85-CHECK DISK CHKDSK AR MEDIA CARD.ahk
; https://github.com/Matthew-Lancaster/Matthew-Lancaster/blob/master/SCRIPTER%20CODE%20--%20AUTOHOTKEY/Autokey%20--%2019-SCRIPT_TIMER_UTIL_2.ahk
; ----
; -------------------------------------------------------------------

; -------------------------------------------------------------------
; SESSION 001
; -------------------------------------------------------------------
; -------------------------------------------------------------------

; -------------------------------------------------------------------
; SESSION 002
; -------------------------------------------------------------------
; -------------------------------------------------------------------
; I SPENT 
; -------------------------------------------------------------------
; Sun 19-Jan-2020 08:05:24
; Sun 19-Jan-2020 10:20:00 -- 2 HOUR
; -------------------------------------------------------------------
; TO LEARN THE FORMAT FOR PUT CODE ONE LINER
; REASON MY BATCH FILE HAS CMD TO EXECUTE RUN
; AND WHEN IT DONE PUT TITLE OF WINDOW FOR THE CMD %comspec%
; BUTT BASTARD PROBLEM
; IF TITLE IS IN THE BATCH CODE
; IT WILL TAKE A TIME BEFORE COME IN
; AND PREVIOUS IT WILL HAVE 
; C:\Windows\System32\cmd.exe
; SO UNABLE TO SEARCH FINDWINDOW LOCATER
; NOT FOR FEW VITAL SECOND LOST
; -------------------------------------------------------------------
; FIRST TIME I CODE THIS UP
; AND BEFORE MANY TIME WANTER
; NONE MY CODE INCLUDE THIS SNIPPET BEFORE
; -------------------------------------------------------------------
; BETWEEN VISUAL BASIC AND _.BAT AND _.VBS VBCRIPT
; VERY HARD SEARCH INTERNET
; NONE EXAMPLE CONSIDER THE PROBLEM BEHAVIOUR OF 
; TITLE WANT IMMEDIATELY - WHY ISSUE DELAY
; THERE NOT A LOT TO IT WHEN LOOKER
; AS LONG QUOTATION MARK PROPER PLACE
; AS LONG GOT THE CODE NOW
; -------------------------------------------------------------------
; SEEING AS AUTOHOTKEYS CAME LATER 
; THAN VISUAL BASIC AND _.BAT AND _.VBS VBSCRIPT
; THAT THE DELAY FOR
; -------------------------------------------------------------------

; -------------------------------------------------------------------
; COMMAND LINE EXAMPLE FOR USER WITH GOODSYNC
; -------------------------------------------------------------------
; "C:\SCRIPTER\SCRIPTER CODE -- AUTOHOTKEY\Autokey -- 85-CHECK DISK CHKDSK AR MEDIA CARD.ahk" NOT_SHOW
; -------------------------------------------------------------------

; -------------------------------------------------------------------
; -------------------------------------------------------------------
; SESSION 003
; -------------------------------------------------------------------
; -------------------------------------------------------------------
; I SPENT BEFORE SESSION 002
; -------------------------------------------------------------------
; Sun 19-Jan-2020 08:05:24
; Sun 19-Jan-2020 10:20:00 -- 2 HOUR
; -------------------------------------------------------------------
; I SPENT ANOTHER -- TOO FINISH OFF COMPLETE
; -------------------------------------------------------------------
; Tue 21-Jan-2020 16:35:01
; Tue 21-Jan-2020 16:35:01 -- 3 HOUR 50 MINUTE
; -------------------------------------------------------------------
; DON'T MISTAKE TO OBSERVE
; CODE HERE IS TWIN WITH MY TIMER VERSION RUN EVERY 24 HOUR
; AND PICKUP FOR REMOTE COMPUTER WANT RUN
; -------------------------------------------------------------------
; HERE PROJECT CODE SET FILENAME AND ROUTINE HEADER
; -------------------------------------------------------------------
; C:\SCRIPTER\SCRIPTER CODE -- AUTOHOTKEY\Autokey -- 85-CHECK DISK CHKDSK AR MEDIA CARD.ahk
; RUN_CHKDSK_FOR_MEDIA_CAR_V_DRIVE_TIMER:
; RUN_CHKDSK_FOR_MEDIA_CAR_V_DRIVE:
; -------------------------------------------------------------------
; ALSO FIND NEW COMPUTER CODER TECHNO TIP
; WHEN RUN FEW LINE OF BATCH FILE _.BAT
; AND PURPOSE TO DELETE AFTER
; SEEM ERROR ALWAYS THROW ERROR NOT TRAPPABLE ABOUT 
; LAST LINE OF NATCH FILE GONE
; IN THAT CASE WRITE THE BATCH AS ALL ONE LINE WITH JOIN 
; COMMAND SYMBOL & OR && WILL STOP RUN MORE IF ERROR BEFORE
; & ALSO FIND 
; NOTEPAD++ ABLE USE DOCUMENT SWITCHER
; RIGHT CLICK FILE DOCUMENT THERE
; SELECT MOVE TO NEW VIEW
; PICK A FEW PROJECT AND WORK THEM SMALL GROUP
; RATHER THAN LOAD OF PROJECT -- WAS LOOK OTHER DAY FOR SEARCHER BE HELP
; PLUGIN HAS SEARCH -- BUT FAIL THAT ONE
; ALSO EASIER SORT OF DOC SWITCH PANEL
; FOUND IN WINDOW PULL DOWN MENU NOT SEEM WORK GOOD AND 
; NONE HOTKEY THAT BASTARD -- NOT WORK SECOND TIME
; ALSO OTHER DAY FIND 
; BUTT CRASHES 
; SourceCookifier v0.7.3.0
; GOOD SHOW PANEL OF ALL ROUTINE IN SCRIPT AND OTHER 
; BUTT ISSUE NOT LIKE LARGE FILE OF TEXT WHEN NOT CODE
; -------------------------------------------------------------------
; Sun 19-Jan-2020 08:05:24
; Sun 19-Jan-2020 10:20:00 -- 2 HOUR
; -------------------------------------------------------------------
; TO LEARN THE FORMAT FOR PUT CODE ONE LINER
; REASON MY BATCH FILE HAS CMD TO EXECUTE RUN
; AND WHEN IT DONE PUT TITLE OF WINDOW FOR THE CMD %comspec%
; BUTT BASTARD PROBLEM
; IF TITLE IS IN THE BATCH CODE
; IT WILL TAKE A TIME BEFORE COME IN
; AND PREVIOUS IT WILL HAVE 
; C:\Windows\System32\cmd.exe
; SO UNABLE TO SEARCH FINDWINDOW LOCATER
; NOT FOR FEW VITAL SECOND LOST
; -------------------------------------------------------------------
; FIRST TIME I CODE THIS UP
; AND BEFORE MANY TIME WANTER
; NONE MY CODE INCLUDE THIS SNIPPET BEFORE
; -------------------------------------------------------------------
; BETWEEN VISUAL BASIC AND _.BAT AND _.VBS VBCRIPT
; VERY HARD SEARCH INTERNET
; NONE EXAMPLE CONSIDER THE PROBLEM BEHAVIOUR OF 
; TITLE WANT IMMEDIATELY - WHY ISSUE DELAY
; THERE NOT A LOT TO IT WHEN LOOKER
; AS LONG QUOTATION MARK PROPER PLACE
; AS LONG GOT THE CODE NOW
; -------------------------------------------------------------------
; SEEING AS AUTOHOTKEYS CAME LATER 
; THAN VISUAL BASIC AND _.BAT AND _.VBS VBSCRIPT
; THAT THE DELAY FOR
; -------------------------------------------------------------------			
; CMD  -- /C OR /K -- /C WILL EXIT OUT -- BATCH FILE REQUIRE EXIT COMMAND ENDER
; START - /B WILL RUN IN SAME DOS SHELL PROMPT WINDOW -- ALL IN ONES
; -------------------------------------------------------------------


; -------------------------------------------------------------------
; SESSION 004
; -------------------------------------------------------------------



#Warn
#NoEnv
#SingleInstance Force
#NoTrayIcon

; -------------------------------------------------------------------
; MODIFY TO EXIT QUICKER
; #Persistent
Exitapp
RETURN
; -------------------------------------------------------------------



; -------------------------------------------------------------------
; IT USER ExitFunc TO EXIT FROM #Persistent
; OR      Exitapp  TO EXIT FROM #Persistent
; Exitapp CALLS ONTO ExitFunc
; -------------------------------------------------------------------

; -------------------------------------------------------------------
; Register a function to be called on exit:
OnExit("ExitFunc")

; Register an object to be called on exit:
OnExit(ObjBindMethod(MyObject, "Exiting"))


; -------------------------------------------------------------------

; -------------------------------------------------------------------
; -------------------------------------------------------------------
; #Include C:\SCRIPTER\SCRIPTER CODE -- AUTOHOTKEY\Autokey -- 00-01_INCLUDE MENU 01 of 03.ahk
;# ------------------------------------------------------------------
; SCRIPT ============================================================

; DetectHiddenWindows, on
; SetStoreCapslockMode, off

; SoundBeep , 2000 , 100
; SoundBeep , 2500 , 100


OSVER_N_VAR:=a_osversion
IF INSTR(a_osversion,".")>0
	OSVER_N_VAR:=substr(a_osversion, 1, INSTR(a_osversion,".")-1)
IF OSVER_N_VAR=WIN_XP
	OSVER_N_VAR=5
IF OSVER_N_VAR=WIN_7
	OSVER_N_VAR=6
; IF OSVER_N_VAR=10
; 	WANT_GO=TRUE

; -------------------------------------------------------------------
; WRITE CODER TIME
; -------------------------------------------------------------------
; Sat 11-Jan-2020 12:18:21
; Sat 11-Jan-2020 15:30:00 -- 3 HOUR 15 MINUTE
; -------------------------------------------------------------------
; -------------------------------------------------------------------
WANT_GO=
IF (A_ComputerName="7-ASUS-GL522VW")
	WANT_GO=TRUE
IF (A_ComputerName="4-ASUS-GL522VW")
	WANT_GO=TRUE
IF (A_ComputerName="8-MSI-GP62M-7RD")
	WANT_GO=TRUE

WAIT_REMOTE_APP_LOAD=
	
REMOTE_BAT_RUN_4=
REMOTE_BAT_RUN_7=
REMOTE_APP_RUN_8=
APP_RUN_5=

PART_2=SCRIPTOR DATA\SCRIPTER CODE -- AUTOHOTKEY\
FILE_1_APP=Autokey -- 85-CHECK DISK CHKDSK AR MEDIA CARD_BAT_#NFS_EX
REMOTE_BAT_RUN_4=\\4-ASUS-GL522VW\4_ASUS_GL522VW_01_C_DRIVE\%PART_2%%FILE_1_APP%_4G.BAT
REMOTE_BAT_RUN_7=\\7-ASUS-GL522VW\7_ASUS_GL522VW_01_C_DRIVE\%PART_2%%FILE_1_APP%_7G.BAT

PART_2=SCRIPTOR DATA\SCRIPTER CODE -- AUTOHOTKEY\
FILE_1_BAT=Autokey -- 85-CHECK DISK CHKDSK AR MEDIA CARD_RUN_REMOTE_EXIST_#NFS_EX
REMOTE_APP_RUN_4=\\4-ASUS-GL522VW\4_ASUS_GL522VW_01_C_DRIVE\%PART_2%%FILE_1_BAT%_4G.TXT
REMOTE_APP_RUN_7=\\7-ASUS-GL522VW\7_ASUS_GL522VW_01_C_DRIVE\%PART_2%%FILE_1_BAT%_7G.TXT
IF INSTR(A_COMPUTERNAME,"4-")>0 
{
	COMP=4G
	BAT_RUN_5=C:\%PART_2%%FILE_1_BAT%_4G.BAT
	APP_RUN_5=C:\%PART_2%%FILE_1_APP%_4G.TXT
	REMOTE_APP_RUN_8=%REMOTE_APP_RUN_7%
	REMOTE_BAT_RUN_8=%REMOTE_BAT_RUN_7%
}
IF INSTR(A_COMPUTERNAME,"7-")>0 
{
	COMP=7G
	BAT_RUN_5=C:\%PART_2%%FILE_1_BAT%_7G.BAT
	APP_RUN_5=C:\%PART_2%%FILE_1_APP%_7G.TXT
	REMOTE_APP_RUN_8=%REMOTE_APP_RUN_4%
	REMOTE_BAT_RUN_8=%REMOTE_BAT_RUN_4%
}




; ---------------------------------------------------------------
; Command-line arguments - Rosetta Code
; https://rosettacode.org/wiki/Command-line_arguments#AutoHotkey
; ---------------------------------------------------------------
; AutoHotkey
; From the AutoHotkey documentation: "The script sees incoming parameters as the variables %1%, %2%, 
; and so on. In addition, %0% contains the number of parameters passed (0 if none). "
; ---------------------------------------------------------------
Command_Params=
Loop %0% ; number of parameters
	Command_Params .= %A_Index% . A_Space
IF %0%=0
	Command_Params=

	
; -------------------------------------------------------------------
PARAM_SET=
FOR n, param in A_Args  ; For each parameter:
{
	PARAM_SET=%PARAM_SET%%A_Space%%PARAM%
}	
; REQUEST RUN REMOTE COMMAND LINE EXIST
; IF REMOTE APP COMMAND LINE EXIST AND BEGIN HAVE DETECT 
; BEEN RUN BY REQUEST REMOTE RUNNING NOT WANT 
; RUN REMOTE BY REPEAT LOOP
; ---------------------------------------------------------------


; Command_Params=

SET_EXIT_VAR=0
IF INSTR(PARAM_SET,"REMOTE_CALL_RUN")>0
	SET_EXIT_VAR=1
IF INSTR(Command_Params,"NOT_SHOW")>0
	SET_EXIT_VAR=1

IF WANT_GO
IF SET_EXIT_VAR=0
{
	Gui, -caption +toolwindow +AlwaysOnTop +Disabled -SysMenu +Owner  ; +Owner avoids a taskbar button.
	Gui Color, White
	Gui font, s30 bold, Arial
	Gui, Add, Text,gLaunchNOTEPAD x10 y10, % COMP "__ Autokey -- 85-CHECK DISK CHKDSK AR MEDIA CARD.ahk"
	; Gui font, cRED s30 bold, Arial	
	; Gui, Add, Text,y10, AHK
	; Gui, Add, Text,gLaunchNOTEPAD x10 y10, AHK
	; Gui, font,c009E9E s14 w600, Arial
	; Gui, font,cRED s16 w600, Arial
	; Gui, Add, Text, x10 y10 W800,%new%
	; Gui, Add, Text, y10 w800,%OutputVar%
	Gui, Show, NoActivate, Title of Window
}

IF WANT_GO
IF INSTR(PARAM_SET,"REMOTE_CALL_RUN")>0
{
	; ---------------------------------------------------------------
	; REMOVE HERE AS _GSDATA_ FREQUENT GET CORRUPT -- MC_CARD
	; ---------------------------------------------------------------
	IFEXIST, \\7-asus-gl522vw\7_asus_gl522vw_82_1_mc_card_camera\_gsdata_
		FileRemoveDir, \\7-asus-gl522vw\7_asus_gl522vw_82_1_mc_card_camera\_gsdata_ ,1
	IFEXIST, \\4-asus-gl522vw\4_asus_gl522vw_82_1_mc_card_camera\_gsdata_
		FileRemoveDir, \\4-asus-gl522vw\4_asus_gl522vw_82_1_mc_card_camera\_gsdata_ ,1
	LOOP ,20
	{
		A=% "found." (SubStr("000", 1, StrLen("000") - StrLen(A_INDEX-1)) . A_INDEX-1)
		FILE1=\\7-asus-gl522vw\7_asus_gl522vw_82_1_mc_card_camera\%A%
		FILE2=\\4-asus-gl522vw\4_asus_gl522vw_82_1_mc_card_camera\%A%
		IFEXIST, %FILE1%
			FileRemoveDir, %FILE1%,1
		IFEXIST, %FILE2%
			FileRemoveDir, %FILE2%,1
	}

	
	WANT_GO=
	; GET STRAIGHT INTO IT IF REMOTE CALL RUN
	; GOSUB LOCAL_APP_AND_REMOTE_WILL_CREATE_FILE_EXIST_FOR_OPERATION
	GOSUB RUN_CHKDSK_FOR_MEDIA_CAR_V_DRIVE_3
	GOSUB RUN_CHKDSK_ENDA
	
}
; -------------------------------------------------------------------
	
IF WANT_GO
{
	GOSUB RUN_CHKDSK_FOR_MEDIA_CAR_V_DRIVE_1
	
}	
	
	
	
	
; -------------------------------------------------------------------
; -------------------------------------------------------------------
	
RETURN

; -------------------------------------------------------------------
; CODE IS RUN TIMER FROM HERE 
; -------------------------------------------------------------------
; C:\SCRIPTER\SCRIPTER CODE -- AUTOHOTKEY\Autokey -- 85-CHECK DISK CHKDSK AR MEDIA CARD.ahk
; -------------------------------------------------------------------
; AND ROUTINE
; -------------------------------------------------------------------
; RUN_CHKDSK_FOR_MEDIA_CAR_V_DRIVE:
; -------------------------------------------------------------------

; -------------------------------------------------------------------
; PARTNER APP THAT CONTROOL HERE OF RUN REMOTE
; SUB REMOTE_APP_RUN_SET_UP_AND_RUN_AUTOKEY_85_C_HDD
; Autokey -- 19-SCRIPT_TIMER_UTIL_2.ahk
; -------------------------------------------------------------------
LOCAL_APP_AND_REMOTE_WILL_CREATE_FILE_EXIST_FOR_OPERATION:
	GOSUB LOCAL_APP_AND_REMOTE_WILL_CREATE_FILE_EXIST_FOR_OPERATION_NOT_GUI
RETURN

LaunchNOTEPAD:
	; MSGBOX "NOTE"
RETURN


LOCAL_APP_AND_REMOTE_WILL_CREATE_FILE_EXIST_FOR_OPERATION_NOT_GUI:
	
	IFEXIST, %REMOTE_APP_RUN_4%
		FileDELETE, %REMOTE_APP_RUN_4%
	IFNOTEXIST, %REMOTE_APP_RUN_7%
		FileDELETE, %REMOTE_APP_RUN_7%
	IFNOTEXIST, %APP_RUN_5%
		FileDELETE, %APP_RUN_5%
		
	FileAppend,"INFO_WRITE_FILE",%REMOTE_APP_RUN_4%
	FileAppend,"INFO_WRITE_FILE",%REMOTE_APP_RUN_7%
	FileAppend,"INFO_WRITE_FILE",%APP_RUN_5%
RETURN

	
RUN_CHKDSK_FOR_MEDIA_CAR_V_DRIVE_1:

	GOSUB LOCAL_APP_AND_REMOTE_WILL_CREATE_FILE_EXIST_FOR_OPERATION

	; ---------------------------------------------------------------
	; REMOVE HERE AS _GSDATA_ FREQUENT GET CORRUPT -- MC_CARD
	; ---------------------------------------------------------------
	IFEXIST, \\7-asus-gl522vw\7_asus_gl522vw_82_1_mc_card_camera\_gsdata_
		FileRemoveDir, \\7-asus-gl522vw\7_asus_gl522vw_82_1_mc_card_camera\_gsdata_ ,1
	IFEXIST, \\4-asus-gl522vw\4_asus_gl522vw_82_1_mc_card_camera\_gsdata_
		FileRemoveDir, \\4-asus-gl522vw\4_asus_gl522vw_82_1_mc_card_camera\_gsdata_ ,1

	PARAM_SET=
	FOR n, param in A_Args  ; For each parameter:
	{
		PARAM_SET=%PARAM_SET%%A_Space%%PARAM%
	}	

	; REQUEST RUN REMOTE COMMAND LINE EXIST
	; IF REMOTE APP COMMAND LINE EXIST AND BEGIN HAVE DETECT 
	; BEEN RUN BY REQUEST REMOTE RUNNING NOT WANT 
	; RUN REMOTE BY REPEAT LOOP
	; ---------------------------------------------------------------
	IF INSTR(PARAM_SET,"REMOTE_CALL_RUN")=0
		GOSUB LOCAL_APP_AND_REMOTE_WILL_CREATE_FILE_EXIST_FOR_OPERATION

	; WAIT 20 SECOND FOR REMOTE BEGIN
	; EVERY TIME WAITER
	; ---------------------------------------------------------------

	SETTIMER RUN_CHKDSK_FOR_MEDIA_CAR_V_DRIVE_2_TIMER_WAITER_APP_TO_LOAD_REMOTE,400
	
RETURN

RUN_CHKDSK_FOR_MEDIA_CAR_V_DRIVE_2_TIMER_WAITER_APP_TO_LOAD_REMOTE:

	IF !WAIT_REMOTE_APP_LOAD
	{
		WAIT_REMOTE_APP_LOAD=%A_Now%
		WAIT_REMOTE_APP_LOAD+= 10, Seconds
	}
	
	IF WAIT_REMOTE_APP_LOAD>0 
	{
		IFEXIST, %APP_RUN_5%
		IFEXIST, %REMOTE_APP_RUN_8%
		{
			Gui, Destroy
			Gui, -caption +toolwindow +AlwaysOnTop +Disabled -SysMenu +Owner  ; +Owner avoid taskbar button.
			Gui, Color, White
			Gui, Font, cBLUE s30 bold, Arial
			Gui, Add, Text,gLaunchNOTEPAD x10 y10, % COMP " __ REMOTE FIND"
			; Gui, font, cRED s30 bold, Arial
			; Gui, Add, Text,y10, AHK
			Gui, Show, NoActivate, Title of Window 
			; SETTIMER OFF
			SETTIMER RUN_CHKDSK_FOR_MEDIA_CAR_V_DRIVE_2_TIMER_WAITER_APP_TO_LOAD_REMOTE,OFF
			GOSUB RUN_CHKDSK_FOR_MEDIA_CAR_V_DRIVE_3
			RETURN
		}
	}
	
	IF WAIT_REMOTE_APP_LOAD>0
	IF WAIT_REMOTE_APP_LOAD<%A_Now%
	{
		Gui, Destroy
		Gui, -caption +toolwindow +AlwaysOnTop +Disabled -SysMenu +Owner  ; +Owner avoid taskbar button.
		Gui, Color, White
		Gui, Font, cBLUE s30 bold, Arial
		Gui, Add, Text,gLaunchNOTEPAD x10 y10, % COMP " __ REMOTE NOT FIND"
		; Gui, font, cRED s30 bold, Arial
		; Gui, Add, Text,y10, AHK
		Gui, Show, NoActivate, Title of Window 
		; SETTIMER OFF
		SETTIMER RUN_CHKDSK_FOR_MEDIA_CAR_V_DRIVE_2_TIMER_WAITER_APP_TO_LOAD_REMOTE,OFF
		GOSUB RUN_CHKDSK_FOR_MEDIA_CAR_V_DRIVE_3
		RETURN
	}
	
RETURN
	

RUN_4_TIMER_WAITER_APP_TO_END_IT_REMOTE:

	IF !WAIT_REMOTE_APP_LOAD
	{
		WAIT_REMOTE_APP_LOAD=%A_Now%
		WAIT_REMOTE_APP_LOAD+= 10, Seconds
	}
	IFEXIST, %APP_RUN_5%
	{
		WAIT_REMOTE_APP_LOAD=%A_Now%
		WAIT_REMOTE_APP_LOAD+= 10, Seconds
	}
	IFEXIST, %REMOTE_APP_RUN_8%
	{
		WAIT_REMOTE_APP_LOAD=%A_Now%
		WAIT_REMOTE_APP_LOAD+= 10, Seconds
	}

	; TOT1=
	; TOT2=
	; IFNOTEXIST, %APP_RUN_5%
	; TOT1=0001X
	; IFNOTEXIST, %REMOTE_APP_RUN_8%
	; TOT2=0001U %REMOTE_APP_RUN_8%

	; TOOLTIP  % TOT1 TOT2
		

	IF WAIT_REMOTE_APP_LOAD>0 
	{
		IFNOTEXIST, %APP_RUN_5%
		IFNOTEXIST, %REMOTE_APP_RUN_8%
		{
			; IF INSTR(PARAM_SET,"REMOTE_CALL_RUN")=0
			; {
			Gui, Destroy
			Gui, -caption +toolwindow +AlwaysOnTop +Disabled -SysMenu +Owner  ; +Owner avoid taskbar button.
			Gui, Color, White
			Gui, Font, cBLUE s30 bold, Arial
			Gui, Add, Text,gLaunchNOTEPAD x10 y10, % COMP " __ REMOTE EXIT TRUE"
			; Gui, font, cRED s30 bold, Arial
			; Gui, Add, Text,y10, AHK
			Gui, Show, NoActivate, Title of Window 
			; }
			SLEEP 400
			SETTIMER RUN_4_TIMER_WAITER_APP_TO_END_IT_REMOTE,OFF
			GOSUB RUN_CHKDSK_ENDA
			RETURN
		}
	}
	
	IF WAIT_REMOTE_APP_LOAD>0
	IF WAIT_REMOTE_APP_LOAD<%A_Now%
	{
		Gui, Destroy
		Gui, -caption +toolwindow +AlwaysOnTop +Disabled -SysMenu +Owner  ; +Owner avoid taskbar button.
		Gui, Color, White
		Gui, Font, cBLUE s30 bold, Arial
		Gui, Add, Text,gLaunchNOTEPAD x10 y10, % COMP " __ REMOTE EXIT FAIL"
		; Gui, font, cRED s30 bold, Arial
		; Gui, Add, Text,y10, AHK
		Gui, Show, NoActivate, Title of Window 
		SETTIMER RUN_4_TIMER_WAITER_APP_TO_END_IT_REMOTE,OFF
		GOSUB RUN_CHKDSK_ENDA
		RETURN
	}
	
RETURN
	
RUN_CHKDSK_ENDA:


	SET_EXIT_VAR=0
	IF INSTR(PARAM_SET,"REMOTE_CALL_RUN")>0
		SET_EXIT_VAR=1
	IF INSTR(Command_Params,"NOT_SHOW")>0
		SET_EXIT_VAR=1
	IF SET_EXIT_VAR=1
		SLEEP 1000
	Gui, Destroy
	EXITAPP

RETURN
	
RUN_CHKDSK_FOR_MEDIA_CAR_V_DRIVE_3:

	; ---------------------------------------------------------------
	; %SCRIPT_NAME_VAR_CHKDSK_2% WILL BE LOCAL COMPUTER FIRST VIA NETWORK PATH
	; ---------------------------------------------------------------

	; ---------------------------------------------------------------
	; INSTRUCTION FOR BATCH FILE SET
	; ---------------------------------------------------------------
	; ---------------------------------------------------------------
	; MAKE THE BATCH FILE
	; ---------------------------------------------------------------
	; CHKDSK.EXE V: /F/X -- X FORCE DISMOUNT OR QUESTION PROMPT
	; ---------------------------------------------------------------
	; CD\
	; TITLE
	; DISPLAY VOL OF V:
	; CHKDSK 
	; DELETE FLAG JOB DONE TXT FILE -- NONE REPORT WHEN SUCCESFUL IN DOS PROMPT SHELL
	; EXIT
	
	FILENAME = %APP_RUN_5%
	FILENAME := """" . FILENAME . """"
	MIDNIGHT_CHKDSK_MC_V="@ECHO OFF&@CD\&@TITLE Autokey -- 85-CHECK DISK CHKDSK AR MEDIA CARD.ahk&@ECHO.&@ECHO.&@VOL V:&@ECHO.&@ECHO.&CHKDSK.EXE V: /F/X&DEL %FILENAME%&EXIT`n" ; -- &PAUSE
	; ---------------------------------------------------------------
	; REMOVE BEGIN AND END QUOTE STING BUILDER
	; ---------------------------------------------------------------
	StringTrimLeft,  MIDNIGHT_CHKDSK_MC_V, MIDNIGHT_CHKDSK_MC_V, 1
	StringTrimRIGHT, MIDNIGHT_CHKDSK_MC_V, MIDNIGHT_CHKDSK_MC_V, 1
	; ---------------------------------------------------------------
	

	; ---------------------------------------------------------------
	; CHANGE -- IFEXIST, X:\MP_ROOT\
	; CHKDSK.EXE V:
	; TO 
	; CHKDSK.EXE X:
	; ---------------------------------------------------------------
	IFEXIST, X:\MP_ROOT\
		StringReplace, MIDNIGHT_CHKDSK_MC_V,MIDNIGHT_CHKDSK_MC_V,&CHKDSK.EXE V: /F/X,&CHKDSK.EXE V: /F/X&@ECHO.&@ECHO.&CHKDSK.EXE X: /F/X, All
	
	; ---------------------------------------------------------------
	; MAKE THE BATCH FILE HAS BEEN DONE
	; ---------------------------------------------------------------
	
	; ---------------------------------------------------------------
	; NOW REQUIRE WRITE ALL COMMAND OF ONE LINE
	; SAVE DEBUG DO FAULT END IF DELETE AFTER BEGIN
	; ---------------------------------------------------------------
	
	; ---------------------------------------------------------------
	; 01 OF 02
	; REMOTE FIRST THEN LOCAL
	; WILL ACT SOON AS FIND BY TIMER ANOTHER CODE PROJECT _.AHK
	; ---------------------------------------------------------------

	; REMOTE FIRST
	IFEXIST, %REMOTE_BAT_RUN_8%
		FileDELETE, %REMOTE_BAT_RUN_8%
	FileAppend,%MIDNIGHT_CHKDSK_MC_V%,%REMOTE_BAT_RUN_8%
	
	; ---------------------------------------------------------------
	; INFO AND WHERE TO WRITE IT
	; ---------------------------------------------------------------
	; %MIDNIGHT_CHKDSK_MC_V%,%SCRIPT_NAME_VAR_CHKDSK_2%
	; ---------------------------------------------------------------
	; ---------------------------------------------------------------
	; 01 OF 02
	; LOCAL SECOND 2ND AR
	; ---------------------------------------------------------------
	IFEXIST, %BAT_RUN_5%
		FileDELETE, %BAT_RUN_5%
	FileAppend,%MIDNIGHT_CHKDSK_MC_V%,%BAT_RUN_5%
	; ---------------------------------------------------------------

	SetTitleMatchMode 2  ; Specify PARTIAL path
	DetectHiddenWindows, on
	
	; WRITE TO NETWORK PATH AND BOTH EXIST LOCAL
	; ---------------------------------------------------------------
	
	; -------------------------------------------------------
	; DISPLAY THE TITLE OF APP IN WINDOW _ FORM START COMMAND
	; Autokey -- 85-CHECK DISK CHKDSK AR MEDIA CARD.ahk
	; -------------------------------------------------------

	; Command_Params="NOT_SHOW"
	
	IFEXIST, %BAT_RUN_5%
	IFWINNOTEXIST Autokey -- 85-CHECK DISK CHKDSK AR MEDIA CARD ahk_class ConsoleWindowClass
	{
		; -------------------------------------------------------
		; MAKE A BAT AND RUN IT
		; -------------------------------------------------------
		; PUTTER THE TITLE AND RUN THE COMMAND
		; -------------------------------------------------------
		; DISPLAY THE TITLE OF APP IN WINDOW _ FORM START COMMAND
		; Autokey -- 85-CHECK DISK CHKDSK AR MEDIA CARD.ahk
		; -------------------------------------------------------
		IF INSTR(Command_Params,"NOT_SHOW")=0 
			RunWAIT, %comspec% /C "START /B /WAIT "Autokey -- 85-CHECK DISK CHKDSK AR MEDIA CARD.ahk" "%BAT_RUN_5%"" ; ,, HIDE
		IF INSTR(Command_Params,"NOT_SHOW")>0 
			RunWAIT, %comspec% /C "START /B /WAIT "Autokey -- 85-CHECK DISK CHKDSK AR MEDIA CARD.ahk" "%BAT_RUN_5%"" ,, HIDE

		IFEXIST, %BAT_RUN_5%
			FileDELETE, %BAT_RUN_5%
	
		SETTIMER RUN_4_TIMER_WAITER_APP_TO_END_IT_REMOTE,400
		
		; -------------------------------------------------------
		; I SPENT 
		; -------------------------------------------------------
		; Sun 19-Jan-2020 08:05:24
		; Sun 19-Jan-2020 10:20:00 -- 2 HOUR
		; -------------------------------------------------------
		; I SPENT ANOTHER -- TOO FINISH OFF COMPLETE
		; -------------------------------------------------------
		; Tue 21-Jan-2020 16:35:01
		; Tue 21-Jan-2020 16:35:01 -- 3 HOUR 50 MINUTE
		; -------------------------------------------------------
		; DON'T MISTAKE TO OBSERVE
		; CODE HERE IS TWIN WITH MY TIMER VERSION RUN EVERY 24 HOUR
		; AND PICKUP FOR REMOTE COMPUTER WANT RUN
		; -------------------------------------------------------
		; HERE PROJECT CODE SET FILENAME AND ROUTINE HEADER
		; -------------------------------------------------------
		; C:\SCRIPTER\SCRIPTER CODE -- AUTOHOTKEY\Autokey -- 85-CHECK DISK CHKDSK AR MEDIA CARD.ahk
		; RUN_CHKDSK_FOR_MEDIA_CAR_V_DRIVE_TIMER:
		; RUN_CHKDSK_FOR_MEDIA_CAR_V_DRIVE:
		; -------------------------------------------------------
		; ALSO FIND NEW COMPUTER CODER TECHNO TIP
		; WHEN RUN FEW LINE OF BATCH FILE _.BAT
		; AND PURPOSE TO DELETE AFTER
		; SEEM ERROR ALWAYS THROW ERROR NOT TRAPPABLE ABOUT 
		; LAST LINE OF NATCH FILE GONE
		; IN THAT CASE WRITE THE BATCH AS ALL ONE LINE WITH JOIN 
		; COMMAND SYMBOL & OR && WILL STOP RUN MORE IF ERROR BEFORE
		; & ALSO FIND 
		; NOTEPAD++ ABLE USE DOCUMENT SWITCHER
		; RIGHT CLICK FILE DOCUMENT THERE
		; SELECT MOVE TO NEW VIEW
		; PICK A FEW PROJECT AND WORK THEM SMALL GROUP
		; RATHER THAN LOAD OF PROJECT -- WAS LOOK OTHER DAY FOR SEARCHER BE HELP
		; PLUGIN HAS SEARCH -- BUT FAIL THAT ONE
		; ALSO EASIER SORT OF DOC SWITCH PANEL
		; FOUND IN WINDOW PULL DOWN MENU NOT SEEM WORK GOOD AND 
		; NONE HOTKEY THAT BASTARD -- NOT WORK SECOND TIME
		; ALSO OTHER DAY FIND 
		; BUTT CRASHES 
		; SourceCookifier v0.7.3.0
		; GOOD SHOW PANEL OF ALL ROUTINE IN SCRIPT AND OTHER 
		; BUTT ISSUE NOT LIKE LARGE FILE OF TEXT WHEN NOT CODE
		; -------------------------------------------------------
		; Sun 19-Jan-2020 08:05:24
		; Sun 19-Jan-2020 10:20:00 -- 2 HOUR
		; -------------------------------------------------------
		; TO LEARN THE FORMAT FOR PUT CODE ONE LINER
		; REASON MY BATCH FILE HAS CMD TO EXECUTE RUN
		; AND WHEN IT DONE PUT TITLE OF WINDOW FOR THE CMD %comspec%
		; BUTT BASTARD PROBLEM
		; IF TITLE IS IN THE BATCH CODE
		; IT WILL TAKE A TIME BEFORE COME IN
		; AND PREVIOUS IT WILL HAVE 
		; C:\Windows\System32\cmd.exe
		; SO UNABLE TO SEARCH FINDWINDOW LOCATER
		; NOT FOR FEW VITAL SECOND LOST
		; -------------------------------------------------------
		; FIRST TIME I CODE THIS UP
		; AND BEFORE MANY TIME WANTER
		; NONE MY CODE INCLUDE THIS SNIPPET BEFORE
		; -------------------------------------------------------
		; BETWEEN VISUAL BASIC AND _.BAT AND _.VBS VBCRIPT
		; VERY HARD SEARCH INTERNET
		; NONE EXAMPLE CONSIDER THE PROBLEM BEHAVIOUR OF 
		; TITLE WANT IMMEDIATELY - WHY ISSUE DELAY
		; THERE NOT A LOT TO IT WHEN LOOKER
		; AS LONG QUOTATION MARK PROPER PLACE
		; AS LONG GOT THE CODE NOW
		; -------------------------------------------------------
		; SEEING AS AUTOHOTKEYS CAME LATER 
		; THAN VISUAL BASIC AND _.BAT AND _.VBS VBSCRIPT
		; THAT THE DELAY FOR
		; -------------------------------------------------------			
		; CMD  -- /C OR /K -- /C WILL EXIT OUT -- BATCH FILE REQUIRE EXIT COMMAND ENDER
		; START - /B WILL RUN IN SAME DOS SHELL PROMPT WINDOW -- ALL IN ONES
		; -------------------------------------------------------
		; -------------------------------------------------------

		; -------------------------------------------------------
		; NOT HAVE RunWAIT -- WILL DEL LINE CREATE SO QUICK NOT RUN AT ALL
		; -------------------------------------------------------

		; -------------------------------------------------------
		; STILL MAYBE PROBLEM OF REMOTE COMPUTER NOT FINISH CHKDSK YET 
		; BEFORE GOODSYNC START JOB
		; -------------------------------------------------------
		
		; -------------------------------------------------------
		; 001 AND 002
		; -------------------------------------------------------
		; EXAMPLE VB LINE CODE
		; -------------------------------------------------------
		; Shell "CMD /C START """" /REALTIME /MAX """ + FILE_EXE_HERE + """", vbMaximizedFocus
		; -------------------------------------------------------
		; 002
		; -------------------------------------------------------
		; EXAMPLE AHK CODE -- %COMSPEC% ONLY AND PIPE _ > _ COMMAND AFTER
		; -------------------------------------------------------
		; Run %comspec% /c ""%FN_VAR%" "/ALL" "" >"%A_TEMP%\IPTEST.TXT , , MIN
		; -------------------------------------------------------
	}
 
RETURN







;# ------------------------------------------------------------------
TIMER_PREVIOUS_INSTANCE:
SETTIMER TIMER_PREVIOUS_INSTANCE,10000

if ScriptInstanceExist()
{
	Exitapp
}
return

ScriptInstanceExist() {
	static title := " - AutoHotkey v" A_AhkVersion
	DHW_2 := A_DetectHiddenWindows
	DetectHiddenWindows, On
	WinGet, match, List, % A_ScriptFullPath . title
	DetectHiddenWindows, % DHW_2
	return (match > 1)
	}
Return

;# ------------------------------------------------------------------
EOF:                           ; on exit
ExitApp     
;# ------------------------------------------------------------------

;# ------------------------------------------------------------------
ExitFunc(ExitReason, ExitCode)
{
    if ExitReason not in Logoff,Shutdown
    {
        ;MsgBox, 4, , Are you sure you want to exit?
        ;IfMsgBox, No
        ;    return 1  ; OnExit functions must return non-zero to prevent exit.
    }
    ; Do not call ExitApp -- that would prevent other OnExit functions from being called.
}

class MyObject
{
    Exiting()
    {
        ;
        ;MsgBox, MyObject is cleaning up prior to exiting...
        /*
        this.SayGoodbye()
        this.CloseNetworkConnections()
        */
    }
}
;# ------------------------------------------------------------------
; exit the app